{"version":3,"sources":["Recorder.js","App.js","index.js"],"names":["Recorder","state","initial","stream","recorder","file","recording","recordTime","calculateTimeDuration","secs","hr","Math","floor","min","sec","onClickDisplay","audioOnly","props","setState","config","navigator","mediaDevices","undefined","alert","getUserMedia","audio","video","then","a","document","getElementById","srcObject","muted","play","catch","e","onClickStart","RecordRTC","mimeType","type","timeSlice","startRecording","startTime","Date","getTime","looper","d","timeDuration","onClickFinish","setTimeout","stopRecording","blob","getBlob","src","URL","createObjectURL","stop","destroy","onClickReset","onChangeFile","v","target","files","console","log","onClickCancel","onHide","this","style","width","height","display","flexDirection","alignItems","justifyContent","padding","backgroundColor","onClick","accept","onChange","id","controls","href","download","React","Component","App","showSelect","onClickAudio","onClickVideo","marginTop","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.7360856d.chunk.js","sourcesContent":["import React from \"react\";\r\nimport RecordRTC from 'recordrtc';\r\n\r\nclass Recorder extends React.Component {\r\n  state = {\r\n    initial: true,\r\n    stream: null,\r\n    recorder: null,\r\n    file: null,\r\n    recording: null,\r\n    recordTime: \"\"\r\n  };\r\n\r\n  calculateTimeDuration = secs => {\r\n    var hr = Math.floor(secs / 3600);\r\n    var min = Math.floor((secs - (hr * 3600)) / 60);\r\n    var sec = Math.floor(secs - (hr * 3600) - (min * 60));\r\n    if (min < 10) min = \"0\" + min;\r\n    if (sec < 10) sec = \"0\" + sec;\r\n    if(hr <= 0) return min + ':' + sec;\r\n    return hr + ':' + min + ':' + sec;\r\n  }\r\n\r\n  onClickDisplay = () => {\r\n    const {audioOnly} = this.props;\r\n    const setState = config => this.setState(config);\r\n    this.setState({initial: false});\r\n    // 마이크와 영상 권한을 얻는다.\r\n    if (navigator.mediaDevices === null || navigator.mediaDevices === undefined ){\r\n      alert(\"이 브라우저는 실시간 녹음 또는 녹화가 지원되지 않습니다. 다른 브라우저를 이용하거나 파일 업로드 기능을 이용해 주세요.\");\r\n      setState({initial: true});\r\n      return;\r\n    }\r\n    navigator.mediaDevices.getUserMedia(\r\n      audioOnly ? { audio: true } : { video: true, audio: true }\r\n    ).then(async function(stream){\r\n      setState({stream, recording: false});\r\n      const video = document.getElementById(\"video\");\r\n      video.srcObject = stream;\r\n      video.muted = true;\r\n      video.play();\r\n    }).catch(e => {\r\n      alert(\"오류가 발생했습니다. 다른 브라우저를 이용하거나 파일 업로드 기능을 이용해 주세요.\");\r\n      setState({initial: true});\r\n    }); \r\n  };\r\n\r\n  onClickStart = () => {\r\n    const {stream} = this.state;\r\n    let recorder = RecordRTC(stream, {\r\n      mimeType: \"video/webm;codecs=vp8\",\r\n      type: \"video\",\r\n      timeSlice: 1000\r\n    });\r\n    recorder.startRecording();\r\n\r\n    const getState = () => this.state;\r\n    const setState = config => this.setState(config);\r\n    const duration = d => this.calculateTimeDuration(d);\r\n    const finish = () => this.onClickFinish();\r\n    \r\n    this.setState({recorder, recording: true}, () => {\r\n      // 녹화 시간 계산\r\n      const startTime = new Date().getTime();\r\n      (function looper() {\r\n        if (!getState().recorder) return;\r\n        const timeDuration = duration((new Date().getTime() - startTime) / 1000);\r\n        if (timeDuration === \"00:10\") finish();\r\n        setState({recordTime: timeDuration});\r\n        setTimeout(looper, 1000);\r\n      })();\r\n    });\r\n  };\r\n  \r\n  onClickFinish = () => {\r\n    const setState = config => this.setState(config);\r\n    const {stream, recorder} = this.state;\r\n    recorder.stopRecording(function() {\r\n      const blob = recorder.getBlob();\r\n      // 비디오 태그에 추가.\r\n      const video = document.getElementById(\"video\");\r\n      video.srcObject = null;\r\n      video.src = URL.createObjectURL(blob);\r\n      video.muted = false;\r\n      video.play();\r\n\r\n\r\n      // 스트림과 레코더 폐기\r\n      stream.stop();\r\n      recorder.destroy();\r\n      setState({recorder: null, stream: null, recording: null, file: blob});\r\n    });\r\n  };\r\n\r\n  onClickReset = () => {\r\n    const {stream, recorder} = this.state;\r\n    // 스트림과 레코더 폐기\r\n    if (stream !== null) stream.stop();\r\n    if (recorder !== null) recorder.destroy();\r\n    this.setState({initial: true, stream: null, recorder: null});\r\n  };\r\n\r\n  onChangeFile = v => {\r\n    const file = v.target.files[0];\r\n    // initial 상태를 풀고, 비디오에 영상을 넣는다.\r\n    this.setState({file, initial: false}, () => {\r\n      console.log(file);\r\n      document.getElementById(\"video\").src = URL.createObjectURL(file);\r\n    });\r\n  };\r\n\r\n  onClickCancel = () => {\r\n    const {stream, recorder} = this.state;\r\n    // 스트림과 레코더 폐기\r\n    if (stream !== null) stream.stop();\r\n    if (recorder !== null) recorder.destroy();\r\n    this.props.onHide();\r\n  };\r\n\r\n  render () {\r\n    const {initial, recording, file, recordTime} = this.state;\r\n    const {audioOnly} = this.props;\r\n    return (\r\n      <div style={{\r\n        width: 400, height: 320, \r\n        display: \"flex\", flexDirection: \"column\", \r\n        alignItems: \"center\", justifyContent: \"space-between\",\r\n        padding: 20, backgroundColor: \"#ddd\"\r\n      }}>\r\n        {initial ? (\r\n          <div style={{\r\n            width: 400, height: 280, display: \"flex\", flexDirection: \"column\", \r\n            alignItems: \"center\", justifyContent: \"center\", backgroundColor: \"white\"}}>\r\n            <button onClick={this.onClickDisplay} >실시간 {audioOnly ? \"녹음\" : \"녹화\"}</button>\r\n            <input type=\"file\" accept={audioOnly ? \"audio/*\" : \"video/*\"} onChange={this.onChangeFile} />\r\n            <span>위 버튼을 누르면 <b>영상 촬영</b>을 할 수 있습니다.</span>\r\n            <span>녹음/녹화를 마치신 후 <b>확인</b> 버튼을 눌러주세요.</span>\r\n          </div>\r\n        ) : (\r\n          <video id=\"video\" controls={recording === null} width={400} height={280} style={{backgroundColor: \"transparent\"}} />\r\n        )}\r\n        <span>녹화 시간: {recordTime}(최대 00:10)</span>\r\n        <div style={{display: \"flex\", flexDirection: \"row\"}}>\r\n          {initial === false && recording === false? (\r\n            <button onClick={this.onClickStart} >녹음 시작</button>\r\n          ) : null}\r\n          {initial === false && recording === true ? (\r\n            <button onClick={this.onClickFinish} >녹음 종료</button>\r\n          ) : null}\r\n          {initial === false && file !== null ? (\r\n            <a href={URL.createObjectURL(file)} download=\"RecordRTC.webm\">다운로드</a>\r\n          ) : null}\r\n          {initial === false ? (\r\n            <button onClick={this.onClickReset} >처음부터</button>\r\n          ) : null}\r\n          <button onClick={this.onClickCancel} >취소</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Recorder;","import React from 'react';\n//import { Player } from 'video-react';\nimport \"video-react/dist/video-react.css\";\nimport Recorder from \"./Recorder\";\n\nclass App extends React.Component {\n  state = {\n    showSelect: false,\n    audioOnly: null\n  };\n\n  onClick = () => this.setState({showSelect: true, audioOnly: null});\n  onClickAudio = () => this.setState({showSelect: false, audioOnly: true});\n  onClickVideo = () => this.setState({showSelect: false, audioOnly: false});\n  onHide = () => this.setState({showSelect: false, audioOnly: null});\n\n  render(){\n    const {showSelect, audioOnly} = this.state;\n    return (\n      <div style={{display: \"block\"}}>\n        <h1>RecordRTC 음성/영상 업로드 프로토타입</h1>\n        <button onClick={this.onClick}>음성 혹은 영상으로 입력하기</button>\n        {showSelect ? (\n          <div style={{marginTop: 30, display: \"block\"}}>\n            <button onClick={this.onClickAudio}>음성으로 입력하기</button>\n            <button onClick={this.onClickVideo}>영상으로 입력하기</button>\n          </div>\n        ) : null}\n        {audioOnly !== null ? (\n          <Recorder audioOnly={audioOnly} onHide={this.onHide}/>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}